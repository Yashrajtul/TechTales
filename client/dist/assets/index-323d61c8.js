import{j as e,A as Le,m as Pe,r as n,L as S,u as ce,a as k,F as De,O as Ne,i as Fe,G as Ee,g as Ue,s as Ie,N as de,I as J,n as j,b as Re,d as Te,P as _e,c as We,e as ze,f as Oe,h as He,k as V,B as Me,_ as W,l as K,o as Qe,R as Je,p as I,q as Ye,t as Xe}from"./.pnpm-06bf3123.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();const qe="/assets/logo-dark-e46e85a3.png",Ve="/assets/logo-light-9e3aca91.png",D=({children:t,keyValue:l,initial:s={opacity:0},animate:o={opacity:1},transition:a={duration:1},className:i})=>e.jsx(Le,{children:e.jsx(Pe.div,{initial:s,animate:o,transition:a,className:i,children:t},l)}),se=(t,l)=>sessionStorage.setItem(t,l),he=t=>sessionStorage.getItem(t),Ze=t=>sessionStorage.removeItem(t),Ke=()=>{const{userAuth:{username:t},setUserAuth:l}=n.useContext(F),s=()=>{Ze("user"),l({access_token:null})};return e.jsx(D,{transition:{duration:.2},className:"absolute right-0 z-50",children:e.jsxs("div",{className:"bg-white absolute right-0 border-grey w-60 duration-200 ",children:[e.jsxs(S,{to:"/editor",className:"flex gap-2 link md:hidden pl-8 py-4 ",children:[e.jsx("i",{className:"fi fi-rr-file-edit"}),e.jsx("p",{children:"Write"})]}),e.jsx(S,{to:`/user/${t}`,className:"link pl-8 py-4 ",children:"Profile"}),e.jsx(S,{to:"/dashboard/blogs",className:"link pl-8 py-4 ",children:"Dashboard"}),e.jsx(S,{to:"/settings/edit-profile",className:"link pl-8 py-4 ",children:"Setting"}),e.jsx("span",{className:"absolute border-t border-grey  w-[100%]"}),e.jsxs("button",{className:"text-left p-4 hover:bg-grey w-full pl-8 py-4",onClick:s,children:[e.jsx("h1",{className:"font-bol text-xl mg-1",children:"Sign Out"}),e.jsxs("p",{className:"text-dark-grey",children:["@",t]})]})]})})},Ge=()=>{const t=ce(),[l,s]=n.useState(!1),[o,a]=n.useState(!1);let{theme:i,setTheme:c}=n.useContext(ne);const{userAuth:m,userAuth:{access_token:h,profile_img:u,new_notification_available:g},setUserAuth:r}=n.useContext(F),d=()=>{a(f=>!f)},b=()=>{setTimeout(()=>{a(!1)},300)},N=f=>{let y=f.target.value;f.keyCode===13&&y.length&&t(`/search/${y}`)};n.useEffect(()=>{h&&k.get("https://techtales-server.onrender.com/new-notification",{headers:{Authorization:`Bearer ${h}`}}).then(({data:f})=>{r({...m,...f})}).catch(f=>{console.log(f)})},[h]);const x=()=>{let f=i==="light"?"dark":"light";c(f),document.body.setAttribute("data-theme",f),se("theme",f)};return e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"z-50 navbar",children:[e.jsxs(S,{to:"/",className:"flex flex-row items-center justify-center",children:[e.jsx(De,{}),e.jsx("span",{className:"ml-2 text-3xl",children:"Techtales"})]}),e.jsxs("div",{className:" absolute bg-white w-full left-0 top-full mt-0.5 border-b border-grey py-4 px-[5vw] md:border-0 md:block md:relative md:inset-0 md:p-0 md:w-auto md:show "+(l?"show":"hide"),children:[e.jsx("input",{type:"text",placeholder:"Search",className:"w-full md:w-auto bg-grey p-4 pl-6 pr-[12%] md:pr-6 rounded-full placeholder:text-dark-grey md:pl-12",onKeyDown:N}),e.jsx("i",{className:"fi fi-rr-search absolute right-[10%] md:pointer-events-none md:left-5 top-1/2 -translate-y-1/2 text-xl text-dark-grey"})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto md:gap-6 ",children:[e.jsx("button",{className:"flex items-center justify-center w-12 h-12 rounded-full md:hidden bg-grey",onClick:()=>s(f=>!f),children:e.jsx("i",{className:"text-xl fi fi-rr-search"})}),e.jsxs(S,{to:"/editor",className:"hidden gap-2 md:flex link ",children:[e.jsx("p",{children:"write"}),e.jsx("i",{className:"fi fi-rr-file-edit"})]}),e.jsx("button",{className:"relative w-12 h-12 rounded-full bg-grey hover:bg-black/10 ",children:e.jsx("i",{className:"fi fi-rr-"+(i=="light"?"moon-stars":"sun")+" text-2xl block mt-1",onClick:x})}),h?e.jsxs(e.Fragment,{children:[e.jsx(S,{to:"/dashboard/notifications",children:e.jsxs("button",{className:"relative w-12 h-12 rounded-full bg-grey hover:bg-black/10 ",children:[e.jsx("i",{className:"block mt-1 fi fi-rr-bell text2xl"}),g&&e.jsx("span",{className:"absolute z-10 w-3 h-3 rounded-full bg-red top-2 right-2"})]})}),e.jsxs("div",{className:"relative",onClick:d,onBlur:b,children:[e.jsx("button",{className:"w-12 h-12 mt1",children:e.jsx("img",{src:u,alt:"Profile",className:"object-cover w-full h-full rounded-full"})}),o&&e.jsx(Ke,{})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"py-2 btn-dark ",to:"/signin",children:"Sign In"}),e.jsx(S,{className:"hidden py-2 btn-light md:block",to:"/signup",children:"Sign Up"})]})]})]}),e.jsx(Ne,{})]})},Q=({name:t,type:l,id:s,value:o,placeholder:a,icon:i,disable:c=!1})=>{const[m,h]=n.useState(!1);return e.jsxs("div",{className:"relative w-[100%] mb-4 ",children:[e.jsx("input",{name:t,type:l==="password"?m?"text":"password":l,placeholder:a,defaultValue:o,id:s,disabled:c,className:"input-box"}),e.jsx("i",{className:"fi "+i+" input-icon"}),l==="password"?e.jsx("i",{className:"fi fi-rr-eye"+(m?"":"-crossed")+" input-icon left-[auto] right-4 cursor-pointer",onClick:()=>h(u=>!u)}):""]})},$e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAoCAYAAACSN4jeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVeSURBVHgBzZhrbBRVFMfPuTO77dKtSCm1BQklppJCjEIfFIkUaHk2IKUEaQwR0FSNaIhA1BZCY2hVPho/CMQH0aatUgU+FLQPln5oKxTKIwEkJWwFoTwKWNjtY2fmeHaBdi3dmV12WfkluzN375mZ/9x79pxzL8ATCkIQUEGB6cb54+P5Lkka0gjUUAIJHQLopirJ7c/sbzwPj0jAwjrmvhwnq8oqDWA+S0vnn6J0zG8DUSOg+EmT5P3xvzdeAz/xW1hH9tQMCdRNRMiCQIIAIQAHAlaYTGLriAPNdiN7Q2FnF0+PjnG6SvnN10II4Af+xV8lo2qP7DCw8831WWmZJGAnnyZBiEGkckWWCxN8jJ7wdWFHdvr7JKj+cYhywy6RLyvqd776hxR2NSv9Q0H0Jb+XT+HBwv7WrvbhGt/9g0XNTpmLKA5AkKHEUJQLZsU3HL7g28aLW/MzEhVFbSCCseAHhHBcEOwD1A6TYv5TEeiSRV8MoJQApOWwwUK2SgxUlBvZu6G46HP+WxuKYptjAml9XG2LbYjudv608qfa3eicnbZaQdyCQOO4eUNFdVF8w9ELRs/oH7HrczIWk6buNb6AtsWq1iK02RTwk8uzJ4+ThWm7BtLG+NqmU/5c0y+st9La2lX53Ev0j9m3taCiuJqWUggDHmGuWnkanzZSj0TddaO13pMjH47sBFvj6o9shjAh7qnDAs8xUsVhORclS+YVQnS7Uj8XRs3I2QJhxDNiSq35EgGN8e5Qrli0u7+OF56pJVjNo/U9hBHRV2OaPFiUGzmhW0S/3gbS2Lsdo7SoCggzMgEm/3fWBpCG98HwlW31mHWmB/wgq8S5jVB7FYKE8/MHskCYoGuFUAf+glocv+PzECRCg0msi2L1jIikNgg/Y1gcDtOzIFXqgjCjAUVxuCD9CC5pZvgfEIjYqWdAqhq0zwSKAF7QcN2lm1BRUCqEHeyUVYRWHDpagJNk+NY5YXnK9vSNR9/e4TK6HWnaXq6Z7WAIzuKvGToGp5EOAle4puvceNq75291GGy4kwF2xequu3KPvla1B0JEVundGq75sn31C61nomDtCj+42rvjUF8Crbmd6RHlhkPKOggR8z/rTtQTxT5/sXZz7BlPElcV+sZ95AUCfO1Mho+70rCLTAPWhJlplbkbIAS4NFW/GCCeQ7hfXUTOUw52aJGn1nZNo13OJB/24ovU8qXLIAiySh1L2J1XGZj92C+MSwzK7Zzz6TFXrN4ChP/FWJFWuXQ9PIqokjsrOF2V6dlw+XW+rshac+/ci5SKZQ3sT6+AAewHZZImb2rOr7Ab2c7clx/rcFhKLFffeFN2pEj694VVdYXWXQ8Jm1qWl6RK2MID+BT4xy+cP3bz9LRGn+tssxXblAXVCyLuOC1jelwwnV9gEfflsJ0n7UXcWkIRN3OHnhUOW/WF1ikDzUHwqL3Fo7YTAscdDd2xTjeFmR0ZauS1NQhahBgQQV2qkF+0fWKxP/jtoaG9svv0sdF5ye5xnQmBgeDHLpBqviRc0c1gckxB1B7UD/jOwcIom7fdkDe6XHXm0Oi8SeyLMBMeAySc6IpuIkmJ0UTvs0X1m6xfDbbR3QZILc97jy22wX0fCTFOToXrjuRXDek2hvsTGeVLEhWUfuPTkFUZ/NATshArm5b/7HPxa7ib05y/x95ytiqZ08i7fEM7BMdt9t2Pos6+kKonyk1AOzrFxcWiesLJFbzozOdLs3l1FWl0DYeMbg4pTbyKrxDRkZV/LCzzqyJ+5K2mlJYCE5y7NVXI2kTOpZyYaST7jJnTbR8SdvKxndunemMsJ07O+8EBAfIvZzP9J7slOesAAAAASUVORK5CYII=",et={apiKey:"AIzaSyAvS4F6rsw9TZF-uunQaFOWG1b1RPudEBo",authDomain:"tt-clone-f03ce.firebaseapp.com",projectId:"tt-clone-f03ce",storageBucket:"tt-clone-f03ce.appspot.com",messagingSenderId:"240158595708",appId:import.meta.VITE_APP_ID};Fe(et);const tt=new Ee,st=Ue(),lt=async()=>{let t=null;return await Ie(st,tt).then(l=>{t=l.user}).catch(l=>{console.log(l)}),t};let at=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,rt=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/;const ue=({type:t})=>{let{userAuth:{access_token:l},setUserAuth:s}=n.useContext(F);const o=(c,m)=>{k.post("https://techtales-server.onrender.com"+c,m).then(({data:h})=>{se("user",JSON.stringify(h)),s(h)}).catch(({response:h})=>{j.error(h.data.error)})},a=c=>{c.preventDefault();let m=t==="sign-in"?"/signin":"/signup",h=new FormData(formElement),u={};for(let[b,N]of h.entries())u[b]=N;let{fullname:g,email:r,password:d}=u;if(g&&g.length<3)return j.error("Full name must be 3 letters long");if(!r.length)return j.error("Enter email");if(!at.test(r))return j.error("Email is invalid");if(!rt.test(d))return j.error("password should be 6 to 20 characters long with a numeric, 1 uppercase and 1 lowercase lettes");o(m,u)},i=c=>{c.preventDefault(),lt().then(m=>{let h="/google-auth",u={access_token:m.accessToken};o(h,u)}).catch(m=>(j.error("Trouble login through Google"),console.log(m)))};return l?e.jsx(de,{to:"/"}):e.jsx(D,{keyValue:t,children:e.jsxs("section",{className:"h-cover flex items-center justify-center",children:[e.jsx(J,{}),e.jsxs("form",{id:"formElement",className:"w-[80%] max-w-[400px]",children:[e.jsx("h1",{className:"text-4xl font-gelasio capitalize text-center mb-24",children:t==="sign-in"?"Welcome Back":"Join us today"}),t!=="sign-in"?e.jsx(Q,{name:"fullname",type:"text",placeholder:"Full Name",icon:"fi-rr-user"}):"",e.jsx(Q,{name:"email",type:"email",placeholder:"Email",icon:"fi-rr-envelope"}),e.jsx(Q,{name:"password",type:"password",placeholder:"Password",icon:"fi-rr-key"}),e.jsx("button",{className:"btn-dark center mt-14",type:"submit",onClick:a,children:t.replace("-"," ")}),e.jsxs("div",{className:"relative w-full flex items-center gap-2 my-10 opacity-10 uppercase text-black font-bold",children:[e.jsx("hr",{className:"w-1/2 border-black"}),e.jsx("p",{children:"Or"}),e.jsx("hr",{className:"w-1/2 border-black"})]}),e.jsxs("button",{onClick:i,className:"btn-dark flex items-center justify-center gap-4 w-[90%] center",children:[e.jsx("img",{src:$e,alt:"googleImg",className:"w-4"}),"Continue with google"]}),t==="sign-in"?e.jsxs("p",{className:"mt-6 text-dark-grey text-xl text-center",children:["Don't have and account ?",e.jsx(S,{to:"/signup",className:"underline text-black text-xl ml-1",children:"Join us Now"})]}):e.jsxs("p",{className:"mt-6 text-dark-grey text-xl text-center",children:["Already a member ?",e.jsx(S,{to:"/signin",className:"underline text-black text-xl ml-1",children:"Sign in here"})]})]})]})})},nt="/assets/blog banner light-4c269e06.png",ot="/assets/blog banner dark-5dfd346c.png",it=t=>new Promise((s,o)=>{try{s(t)}catch(a){o(a)}}).then(s=>({success:1,file:{url:s}})),ct=t=>{},dt={embed:Re,list:{class:Te,inlineToolbar:!0},image:{class:_e,config:{uploader:{uploadByUrl:it,uploadByFile:ct}}},marker:We,header:{class:ze,config:{placeholder:"Type Heading ....",levels:[2,3,4],defaultLevel:2}},inlineCode:Oe,quote:{class:He,inlineToolbar:!0}},ve=async t=>{try{const l=new FormData;return l.append("image",t),(await(await fetch("https://techtales-server.onrender.com/upload-image",{method:"POST",body:l})).json()).url}catch(l){return l}},mt=()=>{const t=ce();let{blog_id:l}=V(),{userAuth:{access_token:s}}=n.useContext(F),{theme:o}=n.useContext(ne),{blog:a,blog:{title:i,banner:c,content:m,tags:h,des:u},setBlog:g,textEditor:r,setTextEditor:d,setEditorState:b}=n.useContext(le);n.useEffect(()=>{r.isReady||d(new Me({holderId:"textEditor",data:Array.isArray(m)?m[0]:m,tools:dt,placeholder:"Let's write an awesome story"}))},[]);const N=C=>{if(C.target.files[0]){let w=j.loading("Uploading...");ve(C.target.files[0]).then(p=>{j.dismiss(w),j.success("Uploaded Successfully"),g({...a,banner:p})}).catch(p=>{j.dismiss(w),j.error(p)})}},x=C=>{C.keyCode===13&&C.preventDefault()},f=C=>{let w=C.target;w.style.height="auto",w.style.height=w.scrollHeight+"px",g({...a,title:w.value})},y=C=>{let w=C.target;w.src=o=="light"?nt:ot},L=()=>{if(!c.length)return j.error("Upload a blog banner to publish it");if(!i.length)return j.error("Write blog title to publis it");r.isReady&&r.save().then(C=>{if(C.blocks.length)g({...a,content:C}),b("publish");else return j.error("Write Something in your blog to publish it")}).catch(C=>{j.error(C)})},P=C=>{if(C.target.className.includes("disable"))return;if(!i.length)return j.error("Write Blog Title before saving it as draft");let w=j.loading("Saving Draft...");C.target.classList.add("disable"),r.isReady&&r.save().then(p=>{let B={title:i,banner:c,des:u,content:p,tags:h,draft:!0};k.post("https://techtales-server.onrender.com/create-blog",{...B,id:l},{headers:{Authorization:`Bearer ${s}`}}).then(()=>{C.target.classList.remove("disable"),j.dismiss(w),j.success("Saved successfully"),setTimeout(()=>{t("/dashboard/blogs?tab=draft")},5e3)}).catch(({response:v})=>(C.target.classList.remove("disable"),j.dismiss(w),j.error(v.data.error)))})};return e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"navbar",children:[e.jsx(S,{to:"/",className:"flex-none w-10",children:e.jsx("img",{src:o=="dark"?Ve:qe,alt:"Logo"})}),e.jsx("p",{className:"max-md:hidden text-black line-clamp-1 w-full",children:i.length?i:"New Blog"}),e.jsxs("div",{className:"flex gap-4 ml-auto",children:[e.jsx("button",{className:"btn-dark py-2 ",onClick:L,children:"Publish"}),e.jsx("button",{className:"btn-light py-2",onClick:P,children:"Save Draft"})]})]}),e.jsx(J,{}),e.jsx(D,{children:e.jsx("section",{children:e.jsxs("div",{className:"mx-auto max-w-[900px] w-full",children:[e.jsx("div",{className:"relative aspect-video hover:opacity-80 bg-white border-4 border-grey",children:e.jsxs("label",{htmlFor:"uploadBanner",children:[e.jsx("img",{src:c,alt:"Default Banner",className:"z-20",onError:y}),e.jsx("input",{type:"file",id:"uploadBanner",accept:".png, .jpg, .jpeg",hidden:!0,onChange:N})]})}),e.jsx("textarea",{defaultValue:i,placeholder:"Blog Title",className:"text-4xl font-medium w-full h-20 outline-none resize-none mt-10 leading-tight placeholder:opacity-40 bg-white",onKeyDown:x,onChange:f}),e.jsx("hr",{className:"w-full opacity-10 my-5"}),e.jsx("div",{id:"textEditor",className:"font-gelasio"})]})})})]})},ht=({tag:t,tagIndex:l})=>{let{blog:{tags:s},setBlog:o,blog:a}=n.useContext(le);const i=()=>{s=s.filter(h=>h!==t),o({...a,tags:s})},c=h=>{if(h.keyCode===13||h.keyCode===188){h.preventDefault();let u=h.target.innerText;s[l]=u,o({...a,tags:s}),h.target.setAttribute("contentEditable",!1)}},m=h=>{h.target.setAttribute("contentEditable",!0),h.target.focus()};return e.jsxs("div",{className:"relative p-2 mt-2 mr-2 px-5 bg-white rounded-full inline-block hover:bg-opacity-50 pr-10",children:[e.jsx("p",{className:"outline-none",onClick:m,onKeyDown:c,children:t}),e.jsx("button",{onClick:i,className:"mt-[2px] rounded-full absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("i",{className:"fi fi-br-cross text-sm pointer-events-none"})})]})},ut=()=>{const s=ce(),{blog_id:o}=V();let{blog:{banner:a,title:i,tags:c,des:m,content:h},setEditorState:u,setBlog:g,blog:r}=n.useContext(le),{userAuth:{access_token:d}}=n.useContext(F);const b=()=>{u("editor")},N=y=>{let L=y.target;g({...r,title:L.value})},x=y=>{if(y.keyCode===13||y.keyCode===188){y.preventDefault();let L=y.target.value;c.length<10?!c.includes(L)&&L.length&&g({...r,tags:[...c,L]}):j.error("You can add max 10 tags"),y.target.value=""}},f=y=>{if(y.target.className.includes("disable"))return;if(!i.length)return j.error("Write Blog Title befor publising");if(!m.length||m.length>200)return j.error("Write a description about your blog within 200 characters to publish");if(!c.length||c.length>10)return j.error("Write some tags about blog within 10 taglimit to publish");let L=j.loading("Publishing..."),P={title:i,banner:a,des:m,content:h,tags:c,draft:!1};y.target.classList.add("disable"),k.post("https://techtales-server.onrender.com/create-blog",{...P,id:o},{headers:{Authorization:`Bearer ${d}`}}).then(()=>{y.target.classList.remove("disable"),j.dismiss(L),j.success("Published successfully"),setTimeout(()=>{s("/dashboard/blogs")},5e3)}).catch(({response:C})=>(y.target.classList.remove("disable"),j.dismiss(L),j.error(C.data.error)))};return e.jsx(D,{children:e.jsxs("section",{className:"w-screen min-h-screen grid items-center lg:grid-cols-2 py-16 lg:gap-4",children:[e.jsx(J,{}),e.jsx("button",{className:"w-12 h-12 absolute right-[5vw] z-10 top-[5%] lg:top-[10%]",onClick:b,children:e.jsx("i",{className:"fi fi-br-cross"})}),e.jsxs("div",{className:"max-w-[500px] center ",children:[e.jsx("p",{className:"text-dark-grey mb-1",children:"Preview"}),e.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden bg-grey mt-4",children:e.jsx("img",{src:a,alt:"Banner"})}),e.jsx("h1",{className:"text-4xl font-medium mt-2 leading-tight line-clamp-2",children:i}),e.jsx("p",{className:"font-gelasio line-clamp-3 text-xl leading-7 mt-4",children:m})]}),e.jsxs("div",{className:"border-grey lg:border-1 lg:pl-4",children:[e.jsx("p",{className:"text-dark-grey mb-2 mt-9",children:"Blog Title"}),e.jsx("input",{type:"text",placeholder:"Blog Title",defaultValue:i,className:"input-box pl-4",onChange:N}),e.jsx("p",{className:"text-dark-grey mb-2 mt-9",children:"Short description about your blog"}),e.jsx("textarea",{maxLength:200,defaultValue:m,className:"h-40 resize-none leading-7 input-box pl-4",onChange:y=>g({...r,des:y.target.value}),onKeyDown:y=>{y.keyCode===13&&y.preventDefault()}}),e.jsxs("p",{className:"mt-1 text-dark-grey text-sm text-right",children:[200-m.length," characters left"]}),e.jsx("p",{className:"text-dark-grey mb-2 mt-9",children:"Topics - ( Helps in searching and ranking your blog post )"}),e.jsxs("div",{className:"relative input-box pl-2 py-2 pb-4",children:[e.jsx("input",{type:"text",placeholder:"Topics",onKeyDown:x,className:"sticky input-box bg-white top-0 lef0 pl-4 mb-3 focus:bg-white"}),c&&c.map((y,L)=>e.jsx(ht,{tagIndex:L,tag:y},L))]}),e.jsxs("p",{className:"mt-1 pt-1 mb-4 text-dark-grey text-right ",children:[10-c.length," Tags left"]}),e.jsx("button",{onClick:f,className:"btn-dark px-8 ",children:"Publish"})]})]})})},z=()=>e.jsx("div",{className:"w-12 mx-auto my-8",children:e.jsxs("svg",{"aria-hidden":"true",className:"w-12 h-12 mr-2 text-white animate-spin fill-dark-grey",viewBox:"0 0 100 101",fill:"none",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]})}),gt={title:"",banner:"",content:[],tags:[],des:"",author:{personal_info:{}}},le=n.createContext({}),ge=()=>{let{blog_id:t}=V();const[l,s]=n.useState(gt),[o,a]=n.useState("editor"),[i,c]=n.useState({isReady:!1});let{userAuth:{access_token:m}}=n.useContext(F);const[h,u]=n.useState(!0);return n.useEffect(()=>{if(!t)return u(!1);k.post("https://techtales-server.onrender.com/get-blog",{blog_id:t,draft:!0,mode:"edit"}).then(({data:{blog:g}})=>{s(g),u(!1)}).catch(g=>{s(null),u(!1),console.log(!1)})},[]),e.jsx(le.Provider,{value:{blog:l,setBlog:s,editorState:o,setEditorState:a,textEditor:i,setTextEditor:c},children:m===null?e.jsx(de,{to:"/signin"}):h?e.jsx(z,{}):o==="editor"?e.jsx(mt,{}):e.jsx(ut,{})})};let te,G;const ae=({routes:t,defaultHidden:l=[],defaultActiveIndex:s=0,children:o})=>{te=n.useRef(),G=n.useRef();let[a,i]=n.useState(s),[c,m]=n.useState(!1),[h,u]=n.useState(window.innerWidth);const g=(r,d)=>{let{offsetWidth:b,offsetLeft:N}=r;te.current.style.width=b+"px",te.current.style.left=N+"px",i(d)};return n.useEffect(()=>{h>766&&a!=s&&g(G.current,s),c||window.addEventListener("resize",()=>{c||m(!0),u(window.innerWidth)})},[h]),n.useEffect(()=>{g(G.current,s)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-8 bg-white border-b border-grey flex flex-nowrap overflow-x-auto",children:[t&&t.map((r,d)=>e.jsx("button",{ref:d===s?G:null,onClick:b=>{g(b.target,d)},className:"p-4 px-5 capitalize "+(a===d?"text-black ":"text-dark-grey ")+(l.includes(r)?" md:hidden ":" "),children:r},d)),e.jsx("hr",{ref:te,className:"absolute bottom-0 duration-300 border-black"})]}),Array.isArray(o)?o[a]:o]})};let ye=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];const Z=t=>{let l=new Date(t);return`${l.getDate()} ${ye[l.getMonth()]}`},xt=t=>{let l=new Date(t);return`${l.getDate()} ${ye[l.getMonth()]} ${l.getFullYear()}`},re=({content:t,author:l})=>{let{publishedAt:s,tags:o,title:a,des:i,banner:c,activity:{total_likes:m},blog_id:h}=t,{fullname:u,profile_img:g,username:r}=l;return e.jsxs(S,{to:`/blog/${h}`,className:"flex gap-8 items-center border-b border-grey pb-5 mb-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex gap-2 items-center mb-7",children:[e.jsx("img",{src:g,alt:u,className:"w-6 h-6 rounded-full"}),e.jsxs("p",{className:"line-clamp-1",children:[u," @",r]}),e.jsx("p",{className:"min-w-fit",children:Z(s)})]}),e.jsx("h1",{className:"blog-title",children:a}),e.jsx("p",{className:"my-3 text-xl font-gelasio leading-7 max-sm:hidden md:max-[1100px]:hidden line-clamp-2",children:i}),e.jsxs("div",{className:"flex gap-4 mt-7",children:[e.jsx("span",{className:"btn-light py-1 px-4",children:o[0]}),e.jsxs("span",{className:"ml-3 flex items-center gap-2 text-dark-grey",children:[e.jsx("i",{className:"fi fi-rr-heart text-xl"}),m]})]})]}),e.jsx("div",{className:"h-28 aspect-square bg-grey",children:e.jsx("img",{src:c,alt:"Banner",className:"w-full h-full aspect-square object-cover"})})]})},xe=({blog:t,index:l})=>{let{title:s,blog_id:o,author:{personal_info:{fullname:a,username:i,profile_img:c}},publishedAt:m}=t;return e.jsxs(S,{to:`/blog/${o}`,className:"flex gap-5 mb-8",children:[e.jsx("h1",{className:"blog-index",children:l<10?"0"+(l+1):l+1}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 items-center mb-7",children:[e.jsx("img",{src:c,alt:a,className:"w-6 h-6 rounded-full"}),e.jsxs("p",{className:"line-clamp-1",children:[a," @",i]}),e.jsx("p",{className:"min-w-fit",children:Z(m)})]}),e.jsx("h1",{className:"blog-title",children:s})]})]})},O=({message:t})=>e.jsx("div",{className:"text-center w-full p-4 rounded-full bg-grey/50 mt-4",children:e.jsx("p",{children:t})}),X=async({create_new_arr:t=!1,state:l,data:s,page:o,countRoute:a,data_to_send:i={},user:c=void 0})=>{let m,h={};return c&&(h.headers={Authorization:`Bearer ${c}`}),l!==null&&!t?m={...l,results:[...l.results,...s],page:o}:await k.post("https://techtales-server.onrender.com"+a,i,h).then(({data:{totalDocs:u}})=>{m={results:s,page:1,totalDocs:u}}).catch(u=>{console.log(u)}),m},q=({state:t,fetchDataFun:l,additionalParam:s})=>{if(t!==null&&t.totalDocs>t.results.length)return e.jsx("button",{onClick:()=>l({...s,page:t.page+1}),className:"text-dark-grey p-2 px-3 hover:bg-grey/30 rounded-md flex items-center gap-2",children:"LoadMore"})},pt=()=>{let[t,l]=n.useState(null),[s,o]=n.useState(null),[a,i]=n.useState("home"),c=["programming","hollywood","food","future","cooking","tech","travel"];const m=({page:r=1})=>{k.post("https://techtales-server.onrender.com/latest-blog",{page:r}).then(async({data:d})=>{let b=await X({state:t,data:d.blogs,page:r,countRoute:"/all-latest-blogs-count"});l(b)}).catch(d=>{console.log(d)})},h=()=>{k.get("https://techtales-server.onrender.com/trending-blog").then(({data:r})=>{o(r.blogs)}).catch(r=>{console.log(r)})},u=({page:r=1})=>{k.post("https://techtales-server.onrender.com/search-blogs",{tag:a,page:r}).then(async({data:d})=>{let b=await X({state:t,data:d.blogs,page:r,countRoute:"/all-search-blogs-count",data_to_send:{tag:a}});l(b)}).catch(d=>{console.log(d)})},g=r=>{let d=r.target.innerText.toLowerCase();if(l(null),a===d){i("home");return}i(d)};return n.useEffect(()=>{G.current.click(),a==="home"?m({page:1}):u({page:1}),s||h()},[a]),e.jsx(D,{children:e.jsxs("section",{className:"h-cover flex justify-center gap-10",children:[e.jsx("div",{className:"w-full",children:e.jsxs(ae,{routes:[a,"trending blog"],defaultHidden:["trending blog"],children:[e.jsxs(e.Fragment,{children:[t===null?e.jsx(z,{}):t.results.length?t.results.map((r,d)=>e.jsx(D,{transition:{duration:1,delay:d*.1},children:e.jsx(re,{content:r,author:r.author.personal_info})},d)):e.jsx(O,{message:"No blog published"}),e.jsx(q,{state:t,fetchDataFun:a==="home"?m:u})]}),s===null?e.jsx(z,{}):s.length?s.map((r,d)=>e.jsx(D,{transition:{duration:1,delay:d*.1},children:e.jsx(xe,{blog:r,index:d})},d)):e.jsx(O,{message:"No blog Trending"})]})}),e.jsx("div",{className:"min-w-[40%] lg:min-w-[400px] max-w-min border-l border-grey pl-8 pt-3 max-md:hidden",children:e.jsxs("div",{className:"flex flex-col gap-10",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-xl mb-8",children:"Stories from all interest"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:c.map((r,d)=>e.jsx("button",{onClick:g,className:"tag "+(a===r?"bg-black text-white":""),children:r},d))})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-medium mb-8",children:["Trending ",e.jsx("i",{className:"fi fi-rr-arrow-trend-up"})]}),s===null?e.jsx(z,{}):s.length?s.map((r,d)=>e.jsx(D,{transition:{duration:1,delay:d*.1},children:e.jsx(xe,{blog:r,index:d})},d)):e.jsx(O,{message:"No blog Trending"})]})]})})]})})},ft=({user:t})=>{let{personal_info:{fullname:l,username:s,profile_img:o}}=t;return e.jsxs(S,{to:`/user/${s}`,className:"flex gap-5 items-center mb-5",children:[e.jsx("img",{src:o,alt:s,className:"w-14 h-15 rounded-full "}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-xl line-clamp-2",children:l}),e.jsxs("p",{className:"text-dark-grey",children:["@",s]})]})]})},bt=()=>{const{query:t}=V(),[l,s]=n.useState(null),[o,a]=n.useState(null),i=({page:u=1,create_new_arr:g=!1})=>{k.post("https://techtales-server.onrender.com/search-blogs",{query:t,page:u}).then(async({data:r})=>{let d=await X({state:l,data:r.blogs,page:u,countRoute:"/all-search-blogs-count",data_to_send:{query:t},create_new_arr:g});s(d)}).catch(r=>{console.log(r)})},c=()=>{k.post("https://techtales-server.onrender.com/search-users",{query:t}).then(({data:{users:u}})=>{a(u)}).catch(u=>{console.log(u)})};n.useEffect(()=>{m(),i({page:1,create_new_arr:!0}),c()},[t]);const m=()=>{s(null),a(null)},h=()=>e.jsx(e.Fragment,{children:o===null?e.jsx(z,{}):o.length?o.map((u,g)=>e.jsx(D,{transition:{duration:1,delay:g*.08},children:e.jsx(ft,{user:u})},g)):e.jsx(O,{message:"No User Found"})});return e.jsxs("section",{className:"h-cover flex justify-center gap-10",children:[e.jsx("div",{className:"w-full",children:e.jsxs(ae,{routes:[`Search Results from "${t}`,"Account Matched"],defaultHidden:["Account Matched"],children:[e.jsxs(e.Fragment,{children:[l===null?e.jsx(z,{}):l.results.length?l.results.map((u,g)=>e.jsx(D,{transition:{duration:1,delay:g*.1},children:e.jsx(re,{content:u,author:u.author.personal_info})},g)):e.jsx(O,{message:"No blog published"}),e.jsx(q,{state:l,fetchDataFun:i})]}),e.jsx(e.Fragment,{children:e.jsx(h,{})})]})}),e.jsxs("div",{className:"min-w-[40%] lg:min-w-[350px] max-w-min border-l border-grey pl-8 pt-3 max-md:hidden",children:[e.jsxs("h1",{className:"font-medium text-xl mb-8",children:["Users Related to search ",e.jsx("i",{className:"fi fi-rr-user mt-1"})]}),e.jsx(h,{})]})]})},jt="/assets/404-light-cbeafc35.png",Nt="/assets/404-dark-6776bc8a.png",vt="data:image/png;base64,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",yt="/assets/full-logo-dark-faf49934.png",we=()=>{let{theme:t}=n.useContext(ne);return e.jsxs("section",{className:"h-cover relative p-10 flex flex-col items-center gap-20 text-center",children:[e.jsx("img",{src:t=="light"?Nt:jt,alt:"404page",className:"select-none border-2 border-grey w-72 aspect-square object-cover rounded"}),e.jsx("h1",{className:"text-4xl font-gelasio leading-7",children:"Page Not Found"}),e.jsxs("p",{className:"text-dark-grey text-xl leadding-7 -mt-8",children:["The page you are looking for does not exixts, Head back to the ",e.jsx(S,{to:"/",className:"text-black underline",children:"home page"})]}),e.jsxs("div",{className:"mt-auto",children:[e.jsx("img",{src:t=="light"?yt:vt,alt:"Logo",className:"h-20 object-contain block mx-auto select-none"}),e.jsx("p",{className:"mt-5 text-dark-grey",children:"Read millions of stories around the world"})]})]})},pe=({className:t,bio:l,social_links:s,joinedAt:o})=>e.jsxs("div",{className:"md:w-[90%] md:mt-7 "+t,children:[e.jsx("p",{className:"text-xl leading-7",children:l.length?l:"Noting to read here"}),e.jsx("div",{className:"flex gap-x-7 gap-y-2 flex-wrap my-7 items-center text-dark-grey",children:Object.keys(s).map(a=>{let i=s[a];return i?e.jsx(S,{to:i,target:"_blank",children:e.jsx("i",{className:"fi "+(a!=="website"?"fi-brands-"+a:"fi-rr-globe")+" text-2xl hover:text-black"})},a):" "})}),e.jsxs("p",{className:"text-xl leading-7 text-dark-grey",children:["Joined on ",xt(o)]})]}),ie={personal_info:{fullname:"",username:"",profile_img:"",bio:""},account_info:{total_posts:0,total_reads:0},social_links:{},joinedAt:""},wt=()=>{const[t,l]=n.useState(ie);let[s,o]=n.useState(!0),[a,i]=n.useState(null),[c,m]=n.useState();const{id:h}=V();let{personal_info:{fullname:u,username:g,profile_img:r,bio:d},account_info:{total_posts:b,total_reads:N},social_links:x,joinedAt:f}=t,{userAuth:{username:y}}=n.useContext(F);const L=()=>{k.post("https://techtales-server.onrender.com/get-profile",{username:h}).then(({data:w})=>{w!==null&&l(w),m(h),P({user_id:w._id}),o(!1)}).catch(w=>{console.log(w),o(!1)})},P=({page:w=1,user_id:p})=>{p=p===void 0?a.user_id:p,k.post("https://techtales-server.onrender.com/search-blogs",{author:p,page:w}).then(async({data:B})=>{let v=await X({state:a,data:B.blogs,page:w,countRoute:"/all-search-blogs-count",data_to_send:{author:p}});v.user_id=p,i(v)}).catch(B=>{console.log(B)})};n.useEffect(()=>{h!==c&&i(null),a===null&&(C(),L())},[h,a]);const C=()=>{l(ie),o(!0),m("")};return e.jsx(D,{children:s?e.jsx(z,{}):g.length?e.jsxs("section",{className:"h-cover md:flex flex-row-reverse items-start gap-5 min-[1100px]:gap-12",children:[e.jsxs("div",{className:"flex flex-col max-md:items-center gap-5 min-w-[250px] md:w-[50%] md:pl-8 md:border-l border-grey md:sticky md:top-[100px] md:py-10",children:[e.jsx("img",{src:r,alt:"Profile img",className:"w-48 h-48 bg-grey rounded-full md:w-32 md:h-32"}),e.jsxs("h1",{className:"text-2xl font-medium",children:["@",g]}),e.jsx("p",{className:"text-xl capitalize h-6",children:u}),e.jsxs("p",{children:[b.toLocaleString()," Blogs -"," ",N.toLocaleString()," Reads"]}),e.jsx("div",{className:"flex gap-4 mt-2",children:h===y?e.jsx(S,{to:"/settings/edit-profile",className:"btn-light rounded-md",children:"Edit Profile"}):""}),e.jsx(pe,{className:"max-md:hidden",bio:d,social_links:x,joinedAt:f})]}),e.jsx("div",{className:"max-md:mt-12 w-full",children:e.jsxs(ae,{routes:["Blogs Published","About"],defaultHidden:["About"],children:[e.jsxs(e.Fragment,{children:[a===null?e.jsx(z,{}):a.results.length?a.results.map((w,p)=>e.jsx(D,{transition:{duration:1,delay:p*.1},children:e.jsx(re,{content:w,author:w.author.personal_info})},p)):e.jsx(O,{message:"No blog published"}),e.jsx(q,{state:a,fetchDataFun:P})]}),e.jsx(pe,{bio:d,joinedAt:f,social_links:x})]})})]}):e.jsx(we,{})})},fe=()=>{let t=n.useContext($),{blog:l,blog:{_id:s,blog_id:o,title:a,activity:i,activity:{total_likes:c,total_comments:m},author:{personal_info:{username:h}}},setBlog:u,isLikedByUser:g,setLikedByUser:r,setCommentsWrapper:d}=t,{userAuth:{username:b,access_token:N}}=n.useContext(F);n.useEffect(()=>{N&&k.post("https://techtales-server.onrender.com/isLiked-by-user",{_id:s},{headers:{Authorization:`Bearer ${N}`}}).then(({data:{result:f}})=>{r(!!f)}).catch(f=>{console.log(f)})},[]);const x=()=>{N?(r(f=>!f),g?c--:c++,u({...l,activity:{...i,total_likes:c}}),k.post("https://techtales-server.onrender.com/like-blog",{_id:s,isLikedByUser:g},{headers:{Authorization:`Bearer ${N}`}}).then(({data:f})=>{console.log(f)}).catch(f=>{console.log(f)})):j.error("Please login to like this blog")};return e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("hr",{className:"border-grey my-2"}),e.jsxs("div",{className:"flex gap-6 justify-between",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("button",{onClick:x,className:"w-10 h-10 rounded-full flex items-center justify-center "+(g?"bg-red/20 text-red":"bg-grey/80"),children:e.jsx("i",{className:"fi "+(g?"fi-sr-heart":"fi-rr-heart")})}),e.jsx("p",{className:"text-xl text-dark-grey",children:c}),e.jsx("button",{onClick:()=>d(f=>!f),className:"w-10 h-10 rounded-full flex items-center justify-center bg-grey/80",children:e.jsx("i",{className:"fi fi-rr-comment-dots"})}),e.jsx("p",{className:"text-xl text-dark-grey",children:m})]}),e.jsxs("div",{className:"flex gap-6 items-center",children:[b===h?e.jsx(S,{to:`/editor/${o}`,className:"underline hover:text-purple",children:"Edit"}):"",e.jsx(S,{to:`https://twitter.com/intent/tweet?text=Read ${a}&url=${location.href}`,children:e.jsx("i",{className:"fi fi-brands-twitter text-xl hover:text-twitter"})})]})]}),e.jsx("hr",{className:"border-grey my-2"})]})},Ct=({url:t,caption:l})=>e.jsxs("div",{children:[e.jsx("img",{src:t,alt:"Img"})," ",l.length?e.jsx("p",{className:"w-full text-center my-3 md:mb-12 text-base text-dark-grey",children:l}):""]}),kt=({quote:t,caption:l})=>e.jsxs("div",{className:"bg-purple/10 p-3 pl-5 border-l-4 border-purple",children:[e.jsx("p",{className:"text-xl leading-10 md:text-2xl",children:t}),l.length?e.jsx("p",{className:"w-full text-purple text-base",children:l}):""]}),At=({style:t,items:l})=>e.jsx("ol",{className:`pl-5 ${t==="ordered"?" list-decimal":" list-disc"}`,children:l.map((s,o)=>e.jsx("li",{className:"my-4",dangerouslySetInnerHTML:{__html:s}},o))}),St=({block:t})=>{let{type:l,data:s}=t;return l==="paragraph"?e.jsx("p",{dangerouslySetInnerHTML:{__html:s.text}}):l==="header"?s.level===3?e.jsx("h3",{className:"text-2xl font-bold",dangerouslySetInnerHTML:{__html:s.text}}):e.jsx("h2",{className:"text-3xl font-bold",dangerouslySetInnerHTML:{__html:s.text}}):l==="image"?e.jsx(Ct,{url:s.file.url,caption:s.caption}):l==="quote"?e.jsx(kt,{quote:s.quote,caption:s.caption}):l==="list"?e.jsx(At,{style:s.style,items:s.items}):e.jsx("h1",{})},Ce=({action:t,index:l=void 0,replyingTo:s=void 0,setReplying:o})=>{let{blog:a,setBlog:i,blog:{_id:c,author:{_id:m},comments:h,comments:{results:u},activity:g,activity:{total_comments:r,total_parent_comments:d}},totalParentComentsLoaded:b,setTotalCommentsLoaded:N}=n.useContext($),{userAuth:{access_token:x,username:f,fullname:y,profile_img:L}}=n.useContext(F);const[P,C]=n.useState(""),w=()=>{if(!x)return j.error("login first to leave a comment");if(!P.length)return j.error("Write something to leave a comment...");k.post("https://techtales-server.onrender.com/add-comment",{_id:c,blog_author:m,comment:P,replying_to:s},{headers:{Authorization:`Bearer ${x}`}}).then(({data:p})=>{C(""),p.commented_by={personal_info:{username:f,fullname:y,profile_img:L}};let B;s?(u[l].children.push(p._id),p.childrenLevel=u[l].childrenLevel+1,p.parentIndex=l,u[l].isReplyLoaded=!0,u.splice(l+1,0,p),B=u,o(!1)):(p.childrenLevel=0,B=[p,...u]);let v=s?0:1;i({...a,comments:{...h,results:B},activity:{...g,total_comments:r+1,total_parent_comments:d+v}}),N(R=>R+v)}).catch(p=>{console.log(p)})};return e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("textarea",{value:P,onChange:p=>C(p.target.value),placeholder:"Leave an comment...",className:"input-box pl-5 placeholder:text-dark-grey resize-none h-[150px] overflow-auto"}),e.jsx("button",{className:"btn-dark mt-5 px-10",onClick:w,children:t})]})},Bt=({index:t,leftVal:l,commentData:s})=>{let{commented_by:{personal_info:{profile_img:o,fullname:a,username:i}},commentedAt:c,comment:m,_id:h,children:u}=s,{blog:g,setBlog:r,blog:{comments:d,activity:b,activity:{total_parent_comments:N},comments:{results:x},author:{personal_info:{username:f}}},setTotalCommentsLoaded:y}=n.useContext($),{userAuth:{access_token:L,username:P}}=n.useContext(F);const[C,w]=n.useState(!1),p=()=>{if(!L)return W.error("Login first to leave a reply");w(A=>!A)},B=()=>{let A=t-1;try{for(;x[A].childrenLevel>=s.childrenLevel;)A--}catch{A=void 0}return A},v=(A,E=!1)=>{if(x[A])for(;x[A].childrenLevel>s.childrenLevel&&(x.splice(A,1),!!x[A]););if(E){let U=B();U!==void 0&&(x[U].children=x[U].children.filter(M=>M!==h),x[U].children.length||(x[U].isReplyLoaded=!1)),x.splice(t,1)}s.childrenLevel===0&&E&&y(U=>U-1),r({...g,comments:{results:x},activity:{...b,total_parent_comments:N-(s.childrenLevel===0&&E?1:0)}})},R=A=>{A.target.setAttribute("disabled",!0),k.post("https://techtales-server.onrender.com/delete-comment",{_id:h},{headers:{Authorization:`Bearer ${L}`}}).then(()=>{A.target.removeAttribute("disabled"),v(t+1,!0)}).catch(E=>{console.log(E)})},T=()=>{s.isReplyLoaded=!1,v(t+1)},H=({skip:A=0,currentIndex:E=t})=>{x[E].children.length&&(T(),k.post("https://techtales-server.onrender.com/get-replies",{_id:x[E]._id,skip:A}).then(({data:{replies:U}})=>{x[E].isReplyLoaded=!0;for(let M=0;M<U.length;M++)U[M].childrenLevel=x[E].childrenLevel+1,x.splice(E+1+M+A,0,U[M]);r({...g,comments:{...d,results:x}})}).catch(U=>{console.log(U)}))},_=()=>{let A=B(),E=e.jsx("button",{onClick:()=>H({skip:t-A,currentIndex:A}),className:"text-dark-grey p-2 px-3 hover:bg-grey/30 rounded-md flex items-center gap-2",children:"Load More Replies"});if(x[t+1]){if(x[t+1].childrenLevel<x[t].childrenLevel&&t-A<x[A].children.length)return E}else if(A&&t-A<x[A].children.length)return E};return e.jsxs("div",{className:"w-full",style:{paddingLeft:`${l*10}px`},children:[e.jsxs("div",{className:"my-5 p-6 rounded-md border border-grey",children:[e.jsxs("div",{className:"flex gap-3 items-center mb-8 ",children:[e.jsx("img",{src:o,alt:"Profile imag",className:"h-6 w-6 rounded-full"}),e.jsxs("p",{className:"line-clamp-1",children:[a," @",i]}),e.jsx("p",{className:"min-w-fit",children:Z(c)})]}),e.jsx("p",{className:"text-xl font-gelasio ml-3",children:m}),e.jsxs("div",{className:"flex gap-5 items-center mt-5",children:[s.isReplyLoaded?e.jsxs("button",{onClick:T,className:"text-dark-grey p-2 px-3 hover:bg-grey/30 rounded-md flex items-center gap-2",children:[e.jsx("i",{className:"fi fi-rs-comment-dots"}),"Hide Reply"]}):e.jsxs("button",{onClick:H,className:"text-dark-grey p-2 px-3 hover:bg-grey/30 rounded-md flex items-center gap-2",children:[e.jsx("i",{className:"fi fi-rs-comment-dots"}),u.length," Reply"]}),e.jsx("button",{onClick:p,className:"underline",children:"Reply"}),P===i||P===f?e.jsx("button",{onClick:R,className:"p-2 px-3 rounded-md border border-grey ml-auto hover:bg-red/30 hover:text-red flex items-center",children:e.jsx("i",{className:"fi fi-rr-trash pointer-events-auto"})}):""]}),C?e.jsx("div",{className:"mt-8",children:e.jsx(Ce,{action:"reply",index:t,replyingTo:h,setReplying:w})}):""]}),e.jsx(_,{})]})},ke=async({skip:t=0,blog_id:l,setParentCommentCountFun:s,comment_array:o=null})=>{let a;return await k.post("https://techtales-server.onrender.com/get-blog-comments",{blog_id:l,skip:t}).then(({data:i})=>{i.map(c=>{c.childrenLevel=0}),s(c=>c+i.length),o===null?a={results:i}:a={results:[...o,...i]}}),a},Lt=()=>{let{blog:{_id:t,title:l,comments:{results:s},activity:{total_parent_comments:o}},commentsWrapper:a,setCommentsWrapper:i,totalParentComentsLoaded:c,setTotalCommentsLoaded:m,setBlog:h,blog:u}=n.useContext($);const g=async()=>{let r=await ke({skip:c,blog_id:t,setParentCommentCountFun:m,comment_array:s});h({...u,comments:r})};return e.jsx("div",{className:"max-sm:w-full fixed "+(a?"top-0 sm:right-0":"top-[100%] sm:right-[-100%]")+" duration-700 max-sm:right-0 sm:top-0 w-[30%] min-w-[350px] h-full z-50 bg-white shadow-2xl p-8 px-16 overflow-y-auto overflow-x-hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx("h1",{className:"text-xl font-medium",children:"Comments"}),e.jsx("p",{className:"text-lg mt-2 w-[70&] text-dark-grey line-clamp-1 ",children:l}),e.jsx("button",{onClick:()=>i(r=>!r),className:"absolute top-0 right-0 flex justify-center items-center w-12 h-12 rounded-full bg-grey",children:e.jsx("i",{className:"fi fi-br-cross text-2xl mt-1"})}),e.jsx("hr",{className:"border-grey my-8 w-[120%] -ml-10"}),e.jsx(Ce,{action:"comment"}),s&&s.length?s.map((r,d)=>e.jsx(D,{children:e.jsx(Bt,{index:d,leftVal:r.childrenLevel*4,commentData:r})},d)):e.jsx(O,{message:"No Comments"}),o>c?e.jsx("button",{onClick:g,className:"text-dark-grey p-2 px-3 hover:bg-grey/30 rounded-md flex items-center gap-2",children:"Load More"}):""]})})},oe={title:"",des:"",content:[],author:{personal_info:{}},banner:"",publishedAt:""},$=n.createContext({}),Pt=()=>{let{blog_id:t}=V();const[l,s]=n.useState(oe),[o,a]=n.useState(oe),[i,c]=n.useState(!0),[m,h]=n.useState(!1),[u,g]=n.useState(!1),[r,d]=n.useState(0);let{title:b,content:N,banner:x,author:{personal_info:{username:f,fullname:y,profile_img:L}},publishedAt:P}=l;const C=()=>{k.post("https://techtales-server.onrender.com/get-blog",{blog_id:t}).then(async({data:{blog:p}})=>{p.comments=await ke({blog_id:p._id,setParentCommentCountFun:d}),s(p),k.post("https://techtales-server.onrender.com/search-blogs",{tag:p.tags[0],limit:6,eliminate_blog:t}).then(({data:{blogs:B}})=>{a(B)}).catch(B=>{console.log(B)}),c(!1)}).catch(p=>{console.log(p),c(!1)})};n.useEffect(()=>{w(),C()},[t]);const w=()=>{s(oe),a(null),c(!0),h(!1),d(0)};return e.jsx(D,{children:i?e.jsx(z,{}):e.jsxs($.Provider,{value:{blog:l,setBlog:s,isLikedByUser:m,setLikedByUser:h,commentsWrapper:u,setCommentsWrapper:g,totalParentComentsLoaded:r,setTotalCommentsLoaded:d},children:[e.jsx(Lt,{}),e.jsxs("div",{className:"max-w-[900px] center py-10 max-lg:px-[5vw]",children:[e.jsx("img",{src:x,alt:"Banner",className:"aspect-video"}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{children:b}),e.jsxs("div",{className:"flex max-sm:flex-col justify-between my-8",children:[e.jsxs("div",{className:"flex gap-5 items-start ",children:[e.jsx("img",{src:L,alt:"Author",className:"w-12 h-12 rounded-full"}),e.jsxs("p",{className:"capitalize ",children:[y,e.jsx("br",{}),"@",e.jsx(S,{className:"underline",to:`/user/${f}`,children:f})]})]}),e.jsxs("p",{className:"text-dark-grey opacity-75 max-sm:mt-6 mx-sm:ml-12 max-sm:pl-5",children:["Published on ",Z(P)]})]})]}),e.jsx(fe,{}),e.jsx("div",{className:"my-12 font-gelasio blog-page-content",children:N[0].blocks.map((p,B)=>e.jsx("div",{className:"my-4 md:my-8",children:e.jsx(St,{block:p})},B))}),e.jsx(fe,{}),o!==null&&o.length?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"font-medium text-2xl mt-14 mb-10",children:"Similar Blogs"}),o&&o.map((p,B)=>{console.log(p);let{author:{personal_info:v}}=p;return e.jsx(D,{transition:{duration:1,delay:B*.08},children:e.jsx(re,{content:p,author:v})},B)})]}):""]})]})})},be=()=>{let{userAuth:{access_token:t,new_notification_available:l}}=n.useContext(F),s=location.pathname.split("/")[2],[o,a]=n.useState(s.replace("-"," ")),[i,c]=n.useState(!1),m=n.useRef(),h=n.useRef(),u=n.useRef();const g=r=>{let{offsetWidth:d,offsetLeft:b}=r.target;console.log(b,d),m.current.style.width=d+"px",m.current.style.left=b+"px",r.target==h.current?c(!0):c(!1)};return n.useEffect(()=>{c(!1),u.current.click()},[o]),t===null?e.jsx(de,{to:"/signin"}):e.jsx(e.Fragment,{children:e.jsxs("section",{className:"relative flex gap-10 py-0 m-0 max-md:flex-col",children:[e.jsxs("div",{className:"skicky top-[80px] z-30",children:[e.jsxs("div",{className:"relative md:hidden bg-white py-1 border-b border-grey flex flex-nowrap overflow-x-auto ",children:[e.jsx("button",{ref:h,className:"p-5 capitalize ",onClick:g,children:e.jsx("i",{className:"fi fi-rr-bars-staggered pointer-events-none"})}),e.jsx("button",{ref:u,className:"p-5 capitalize ",onClick:g,children:o}),e.jsx("hr",{ref:m,className:"absolute bottom-0 duration-500 "})]}),e.jsxs("div",{className:"min-w-[200px] h-[calc(100vh-80px-64px)] md:h-cover md:sticky top-24 overflow-y-auto p-6 md:pr-0 md:border-grey md:border-r absolute max-md:top-[64px] bg-white max-md:w-[calc(100%+80px)] max-md:px-16 max-md:-ml-7 duration-500 "+(i?"opacity-100 pointer-events-auto":"max-md:opacity-0 max-md:pointer-events-none"),children:[e.jsx("h1",{className:"text-xl text-dark-grey mb-3",children:"Dashboard"}),e.jsx("hr",{className:"border-grey -ml-6 mb-8 mr-6"}),e.jsxs(K,{to:"/dashboard/blogs",onClick:r=>a(r.target.innerText),className:"sidebar-link",children:[e.jsx("i",{className:"fi fi-rr-document"}),"Blogs"]}),e.jsxs(K,{to:"/dashboard/notifications",onClick:r=>a(r.target.innerText),className:"sidebar-link",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fi fi-rr-bell"}),l&&e.jsx("span",{className:"bg-red h-2 w-2 rounded-full absolute z-10 top-0 right-0"})]}),"Notification"]}),e.jsxs(K,{to:"/editor",onClick:r=>a(r.target.innerText),className:"sidebar-link",children:[e.jsx("i",{className:"fi fi-rr-file-edit"}),"Write"]}),e.jsx("h1",{className:"text-xl text-dark-grey mb-3 mt-20",children:"Setting"}),e.jsx("hr",{className:"border-grey ml-6 mb-8 mr-6"}),e.jsxs(K,{to:"/settings/edit-profile",onClick:r=>a(r.target.innerText),className:"sidebar-link",children:[e.jsx("i",{className:"fi fi-rr-user"}),"Edit Profile"]}),e.jsxs(K,{to:"/settings/change-password",onClick:r=>a(r.target.innerText),className:"sidebar-link",children:[e.jsx("i",{className:"fi fi-rr-lock"}),"Change Password"]})]})]}),e.jsx("div",{className:"max-md:-mt-8 mt-5 w-full",children:e.jsx(Ne,{})})]})})},Dt=()=>{let{userAuth:{access_token:t}}=n.useContext(F),l=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/,s=n.useRef();const o=a=>{a.preventDefault();let i=new FormData(s.current),c={};for(let[g,r]of i.entries())c[g]=r;let{currentPassword:m,newPassword:h}=c;if(!m.length||!h.length)return j.error("Fill all th inputs");if(!l.test(m)||!l.test(h))return j.error("password should be 6 to 20 characters long with a numeric, 1 uppercase and 1 lowercase lettes");a.target.setAttribute("disabled",!0);let u=j.loading("Updating...");k.post("https://techtales-server.onrender.com/change-password",c,{headers:{Authorization:`Bearer ${t}`}}).then(()=>(j.dismiss(u),a.target.removeAttribute("disabled"),j.success("Password Updated"))).catch(({response:g})=>(j.dismiss(u),a.target.removeAttribute("disabled"),j.error(g.data.error)))};return e.jsxs(D,{children:[e.jsx(J,{}),e.jsxs("form",{ref:s,children:[e.jsx("h1",{className:"max-md:hidden",children:"Change Password"}),e.jsxs("div",{className:"py-10 w-full md:max-w-[400px]",children:[e.jsx(Q,{name:"currentPassword",type:"password",className:"profile-edit-input",placeholder:"Current Password",icon:"fi-rr-unlock"}),e.jsx(Q,{name:"newPassword",type:"password",className:"profile-edit-input",placeholder:"New Password",icon:"fi-rr-unlock"}),e.jsx("button",{onClick:o,className:"btn-dark px-10",type:"submit",children:"Change Password"})]})]})]})},Ft=()=>{let t=150,{userAuth:l,userAuth:{access_token:s},setUserAuth:o}=n.useContext(F);const[a,i]=n.useState(ie),[c,m]=n.useState(!0),[h,u]=n.useState(t),[g,r]=n.useState(null);let d=n.useRef(),b=n.useRef(),{personal_info:{profile_img:N,fullname:x,username:f,email:y,bio:L},social_links:P}=a;console.log(a),n.useEffect(()=>{s&&k.post("https://techtales-server.onrender.com/get-profile",{username:l.username}).then(({data:v})=>{i(v),m(!1)}).catch(v=>{console.log(v),m(!1)})},[s]);const C=v=>{u(t-v.target.value.length)},w=v=>{let R=v.target.files[0];d.current.src=URL.createObjectURL(R),r(R)},p=v=>{if(v.preventDefault(),g){let R=W.loading("Uploading...");v.target.setAttribute("disabled",!0),ve(g).then(T=>{T&&k.post("https://techtales-server.onrender.com/update-profile-img",{url:T},{headers:{Authorization:`Bearer ${s}`}}).then(({data:H})=>{let _={...l,profile_img:H.profile_img};se("user",JSON.stringify(_)),o(_),r(null),W.dismiss(R),W.success("Uploaded Successfully :)"),v.target.removeAttribute("disabled")})}).catch(({response:T})=>{v.target.removeAttribute("disabled"),W.dismiss(R),W.error(T.data.error)})}},B=v=>{v.preventDefault();let R=new FormData(b.current),T={};for(let[Y,ee]of R.entries())T[Y]=ee;let{username:H,bio:_,youtube:A,facebook:E,twitter:U,github:M,instagram:Se,website:Be}=T;if(H.length<3)return W.error("Username should be at least 3 letters long");if(_.length>t)return W.error(`Bio should not be more than ${t} characters `);let me=W.loading("Updating...");v.target.setAttribute("disabled",!0),k.post("https://techtales-server.onrender.com/update-profile",{username:H,bio:_,social_links:{youtube:A,facebook:E,twitter:U,github:M,instagram:Se,website:Be}},{headers:{Authorization:`Bearer ${s}`}}).then(({data:Y})=>{if(l.username!=Y.username){let ee={...l,username:Y.username};se("user",JSON.stringify(ee)),o(ee)}W.dismiss(me),v.target.removeAttribute("disabled"),W.success("Profile updated successfully :)")}).catch(({response:Y})=>{W.dismiss(me),v.target.removeAttribute("disabled"),W.error(Y.data.error)})};return e.jsx(D,{children:c?e.jsx(z,{}):e.jsxs("form",{ref:b,children:[e.jsx(J,{}),e.jsx("h1",{className:"max-md:hidden",children:"Edit Profile"}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-start py-10 gap-8 lg:gap-10",children:[e.jsxs("div",{className:"max-lg:center mb-5",children:[e.jsxs("label",{htmlFor:"uploadImg",id:"profileImgLabel",className:"relative block w-48 h-48 bg-grey rounded-full overflow-hidden",children:[e.jsx("div",{className:"w-full h-full absolute top-0 left-0 flex items-center justify-center text-white bg-black/30 opacity-0 hover:opacity-100 cursor-pointer",children:"Upload Image"}),e.jsx("img",{ref:d,src:N,alt:"Profile Img"})]}),e.jsx("input",{type:"file",id:"uploadImg",accept:".jpeg, .png, .jpg",hidden:!0,onChange:w}),e.jsx("button",{className:"btn-light mt-5 max-lg:center lg:w-full px-10",onClick:p,children:"Upload"})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-5",children:[e.jsx("div",{children:e.jsx(Q,{name:"fullname",type:"text",value:x,placeholder:"Full Name",icon:"fi-rr-user",disable:!0})}),e.jsx("div",{children:e.jsx(Q,{name:"email",type:"email",value:y,placeholder:"Email",icon:"fi-rr-envelope",disable:!0})})]}),e.jsx(Q,{type:"text",name:"username",value:f,placeholder:"Username",icon:"fi-rr-at"}),e.jsx("p",{className:"text-dark-grey -mt-3",children:"Username will use to search user and will be visible to all users"}),e.jsx("textarea",{name:"bio",maxLength:t,defaultValue:L,className:"input-box h-64 lg:h-40 resize-none leading-7 mt-5 pl-5",placeholder:"Bio",onChange:C}),e.jsxs("p",{className:"mt-1 text-dark-grey",children:[h," characters left"]}),e.jsx("p",{className:"my-6 text-dark-grey",children:"Add your social handles below"}),e.jsx("div",{className:"md:grid md:grid-cols-2 gap-x-6",children:Object.keys(P).map((v,R)=>{let T=P[v];return e.jsx(Q,{name:v,type:"text",value:T,placeholder:"https://",icon:"fi "+(v!=="website"?"fi-brands-"+v:"fi-rr-globe")},R)})}),e.jsx("button",{className:"btn-dark w-auto px-10",type:"submit",onClick:B,children:"Update"})]})]})]})})},Et=({_id:t,blog_author:l,index:s=void 0,replyingTo:o=void 0,setReplying:a,notification_id:i,notificationData:c})=>{let[m,h]=n.useState(""),{_id:u}=l,{userAuth:{access_token:g}}=n.useContext(F),{notifications:r,notifications:{results:d},setNotifications:b}=c;const N=()=>{if(!m.length)return W.error("Write something to leave a comment...");k.post("https://techtales-server.onrender.com/add-comment",{_id:t,blog_author:u,comment:m,replying_to:o,notification_id:i},{headers:{Authorization:`Bearer ${g}`}}).then(({data:x})=>{a(!1),h(""),d[s].reply={comment:m,_id:x._id},b({...r,results:d})}).catch(x=>{console.log(x)})};return e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("textarea",{value:m,onChange:x=>h(x.target.value),placeholder:"Leave an Reply...",className:"input-box pl-5 placeholder:text-dark-grey resize-none h-[150px] overflow-auto"}),e.jsx("button",{className:"btn-dark mt-5 px-10",onClick:N,children:"Reply"})]})},Ut=({data:t,index:l,notificationState:s})=>{let[o,a]=n.useState(!1),{seen:i,type:c,reply:m,replied_on_comment:h,comment:u,createdAt:g,user:r,user:{personal_info:{profile_img:d,fullname:b,username:N}},blog:{_id:x,blog_id:f,title:y},_id:L}=t,{userAuth:{username:P,profile_img:C,access_token:w}}=n.useContext(F),{notifications:p,notifications:{results:B,totalDocs:v},setNotifications:R}=s;const T=(_,A,E)=>{E.setAttribute("disabled",!0),k.post("https://techtales-server.onrender.com/delete-comment",{_id:_},{headers:{Authorization:`Bearer ${w}`}}).then(()=>{A=="comment"?B.splice(l,1):delete B[l].reply,E.removeAttribute("disabled"),R({...p,results:B,totalDocs:v-1,deletedDocCount:p.deletedDocCount+1})}).catch(U=>{console.log(U)})},H=()=>{a(_=>!_)};return e.jsxs("div",{className:"p-6 border-b border-grey border-l-black "+(i?"":"border-l-2"),children:[e.jsxs("div",{className:"flex gap-5 mb-3",children:[e.jsx("img",{src:d,alt:"profile_img",className:"w-14 h-14 flex-none rounded-full"}),e.jsxs("div",{className:"w-full ",children:[e.jsxs("h1",{className:"text-xl font-medium text-dark-grey",children:[e.jsx("span",{className:"lg:inline-block hidden capitalize",children:b}),e.jsxs(S,{className:"mx-1 text-black underline",to:`/user/${N}`,children:["@",N]}),e.jsx("span",{className:"font-normal",children:c=="like"?"liked your blog":c=="comment"?"commented on":"replied on"})]}),c=="reply"?e.jsx("div",{className:"p-4 mt-4 rounded-md bg-grey",children:e.jsx("p",{children:h.comment})}):e.jsx(S,{to:`/blog/${f}`,className:"font-medium text-dark-grey hover:underline line-clamp-1",children:`"${y}"`})]})]}),c!=="like"?e.jsxs("p",{className:"ml-14 pl-5 font-gelasio text-xl my-5",children:[" ",u.comment]}):"",e.jsxs("div",{className:"ml-14 pl-5 mt-3 text-dark-grey flex gap-8",children:[e.jsx("p",{children:Z(g)}),c!=="like"?e.jsxs(e.Fragment,{children:[!m&&e.jsx("button",{onClick:H,className:"underline hover:text-black",children:"Reply"}),e.jsx("button",{onClick:_=>T(u._id,"comment",_.target),className:"underline hover:text-black",children:"Delete"})]}):""]}),o?e.jsx("div",{className:"mt-8",children:e.jsx(Et,{_id:x,blog_author:r,index:l,replyingTo:u._id,setReplying:a,notification_id:L,notificationData:s})}):"",m?e.jsxs("div",{className:"ml-20 p-5 bg-grey mt-5 rounded-md ",children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsx("img",{src:C,alt:"",className:"w-8 h-8 rounded-full"}),e.jsx("div",{children:e.jsxs("h1",{className:"font-medium text-xl text-dark-grey",children:[e.jsxs(S,{className:"mx-1 text-black underline",to:`/user/${P}`,children:["@",P]}),e.jsx("span",{className:"font-normal",children:"replied to"}),e.jsxs(S,{className:"mx-1 text-black underline",to:`/user/${N}`,children:["@",N]})]})})]}),e.jsx("p",{className:"ml-14 font-gelasio text-xl my-2",children:m.comment}),e.jsx("button",{onClick:_=>T(u._id,"reply",_.target),className:"ml-14 mt-2 underline hover:text-black",children:"Delete"})]}):""]})},It=()=>{let{userAuth:t,setUserAuth:l,userAuth:{access_token:s,new_notification_available:o}}=n.useContext(F);const[a,i]=n.useState("all"),c=["all","like","comment","reply"],[m,h]=n.useState(null),u=({page:r,deletedDocCount:d=0})=>{k.post("https://techtales-server.onrender.com/notifications",{page:r,filter:a,deletedDocCount:d},{headers:{Authorization:`Bearer ${s}`}}).then(async({data:{notifications:b}})=>{o&&l({...t,new_notification_available:!1});let N=await X({state:m,data:b,page:r,countRoute:"/all-notifications-count",data_to_send:{filter:a},user:s});h(N)}).catch(b=>{console.log(b)})},g=r=>{let d=r.target;i(d.innerHTML),h(null)};return n.useEffect(()=>{s&&u({page:1})},[s,a]),e.jsxs("div",{children:[e.jsx("h1",{className:"max-md:hidden",children:"Recent Notification"}),e.jsx("div",{className:"my-8 flex gap-6 ",children:c.map((r,d)=>e.jsx("button",{className:"py-2 "+(a==r?"btn-dark":"btn-light"),onClick:g,children:r},d))}),m==null?e.jsx(z,{}):e.jsxs(e.Fragment,{children:[m.results.length?m.results.map((r,d)=>e.jsx(D,{transition:{delay:d*.08},children:e.jsx(Ut,{data:r,index:d,notificationState:{notifications:m,setNotifications:h}})},d)):e.jsx(O,{message:"Nothing Available"}),e.jsx(q,{state:m,fetchDataFun:u,additionalParam:{deletedDocCount:m.deletedDocCount}})]})]})},je=({stats:t})=>e.jsx("div",{className:"flex gap-2 max-lg:mb-6 max-lg:pb-4 max-lg:border-grey max-lg:border-b ",children:Object.keys(t).map((l,s)=>l.includes("parent")?"":e.jsxs("div",{className:"flex flex-col items-center w-full h-full justify-center p-4 px-6 "+(s!==0?"border-grey border-l":""),children:[e.jsx("h1",{className:"text-xl lg:text-2xl mb-2",children:t[l].toLocaleString()}),e.jsx("p",{className:"max-lg:text-dark-grey capitalize",children:l.split("_")[1]})]},s))}),Rt=({blog:t})=>{let{userAuth:{access_token:l}}=n.useContext(F),{banner:s,blog_id:o,title:a,publishedAt:i,activity:c}=t,[m,h]=n.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-10 border-b mb-6 max-md:px-4 border-grey pb-6 items-center ",children:[e.jsx("img",{src:s,alt:"banner img",className:"max-md:hidden lg:hidden xl:block w-28 h-28 bg-grey object-cover"}),e.jsxs("div",{className:"flex flex-col justify-between py-2 w-full min-w-[300px]",children:[e.jsxs("div",{children:[e.jsx(S,{to:`/blog/${o}`,className:"blog-title mb-4 hover:underline",children:a}),e.jsxs("p",{className:"line-clamp-1",children:["Published on ",Z(i)]})]}),e.jsxs("div",{className:"flex gap-6 mt-3",children:[e.jsx(S,{to:`/editor/${o}`,className:"py-2 underline ",children:"Edit"}),e.jsx("button",{className:"lg:hidden pr-4 py-2 underline",onClick:()=>h(u=>!u),children:"Stats"}),e.jsx("button",{className:"pr-4 py-2 underline text-red",onClick:u=>Ae(t,l,u.target),children:"Delete"})]})]}),e.jsx("div",{className:"max-lg:hidden",children:e.jsx(je,{stats:c})})]}),m&&e.jsx("div",{className:"max-lg:hidden",children:e.jsx(je,{stats:c})})]})},Tt=({blog:t})=>{let{title:l,blog_id:s,des:o,index:a}=t;a++;let{userAuth:{access_token:i}}=n.useContext(F);return e.jsxs("div",{className:"flex gap-5 lg:gap-10 pb-6 border-b mb-6 border-grey",children:[e.jsx("h1",{className:"blog-index text-center pl-4 md:pl-6 flex-none",children:a<10?"0"+a:a}),e.jsxs("div",{children:[e.jsx("h1",{className:"blog-title mb-3",children:l}),e.jsx("p",{className:"line-clamp-2 font-gelasio",children:o.length?o:"No Description"}),e.jsxs("div",{className:"flex gap-6 mt-3",children:[e.jsx(S,{className:"pr-4 py-2 underline",to:`/editor/${s}`,children:"Edit"}),e.jsx("button",{className:"pr-4 py-2 underline text-red",onClick:c=>Ae(t,i,c.target),children:"Delete"})]})]})]})},Ae=(t,l,s)=>{let{index:o,blog_id:a,setStateFunc:i}=t;s.setAttribute("disable",!0),k.post("https://techtales-server.onrender.com/delete-blog",{blog_id:a},{headers:{Authorization:`Bearer ${l}`}}).then(({data:c})=>{s.removeAttribute("disabled"),i(m=>{let{deleteDocCount:h,totalDocs:u,results:g}=m;return g.splice(o,1),h||(h=0),!g.length&&u-1>0?null:{...m,totalDocs:u-1,deleteDocCount:h+1}})}).catch(c=>{console.log(c)})},_t=()=>{const[t,l]=n.useState(null),[s,o]=n.useState(null),[a,i]=n.useState("");let c=Qe()[0].get("tab"),{userAuth:{access_token:m}}=n.useContext(F);const h=({page:r,draft:d,deletedDocCount:b=0})=>{k.post("https://techtales-server.onrender.com/user-written-blogs",{page:r,draft:d,query:a,deletedDocCount:b},{headers:{Authorization:`Bearer ${m}`}}).then(async({data:N})=>{let x=await X({state:d?s:t,data:N.blogs,page:r,user:m,countRoute:"/user-written-blogs-count",data_to_send:{draft:d,query:a}});console.log(x),d?o(x):l(x)}).catch(N=>{console.log(N)})},u=r=>{r.target.value.length&&(i(""),l(null),o(null))},g=r=>{let d=r.target.value;i(d),r.keyCode==13&&d.length&&(l(null),o(null))};return n.useEffect(()=>{m&&(t==null&&h({page:1,draft:!1}),s==null&&h({page:1,draft:!0}))},[m,t,s,a]),e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"max-md:hidden text-2xl",children:"Manage Blog"}),e.jsx(J,{}),e.jsxs("div",{className:"relative max-md:mt-5 md:mt-8 mb-10",children:[e.jsx("input",{type:"search",className:"w-full bg-grey p-4 pl-12 pr-6 rounded-full placeholder:text-dark-grey",placeholder:"Search Blogs",onChange:u,onKeyDown:g}),e.jsx("i",{className:"fi fi-rr-search absolute right-[10%] md:pointer-events-none md:left-5 top-1/2 -translate-y-1/2 text-xl text-dark-grey"})]}),e.jsxs(ae,{routes:["Published Blogs","Drafts Blogs"],defaultActiveIndex:c!=="draft"?0:1,children:[t==null?e.jsx(z,{}):t.results.length?e.jsxs(e.Fragment,{children:[t.results.map((r,d)=>e.jsx(D,{transition:{delay:d*.04},children:e.jsx(Rt,{blog:{...r,index:d,setStateFunc:l}})},d)),e.jsx(q,{state:t,fetchDataFun:h,additionalParam:{draft:!1,deletedDocCount:t.deletedDocCount}})]}):e.jsx(O,{message:"No Published Blogs Available"}),s==null?e.jsx(z,{}):s.results.length?e.jsxs(e.Fragment,{children:[s.results.map((r,d)=>e.jsx(D,{transition:{delay:d*.04},children:e.jsx(Tt,{blog:{...r,index:d,setStateFunc:o}})},d)),e.jsx(q,{state:s,fetchDataFun:h,additionalParam:{draft:!0,deletedDocCount:s.deletedDocCount}})]}):e.jsx(O,{message:"No Draft Blogs Available"})]})]})},F=n.createContext({}),ne=n.createContext({}),Wt=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,zt=()=>{const[t,l]=n.useState({}),[s,o]=n.useState(()=>Wt()?"dark":"light");return n.useEffect(()=>{let a=he("user"),i=he("theme");l(a?JSON.parse(a):{access_token:null}),i?o(()=>(document.body.setAttribute("data-theme",i),i)):document.body.setAttribute("data-theme",s)},[]),e.jsx(ne.Provider,{value:{theme:s,setTheme:o},children:e.jsx(F.Provider,{value:{userAuth:t,setUserAuth:l},children:e.jsxs(Je,{children:[e.jsx(I,{path:"/editor",element:e.jsx(ge,{})}),e.jsx(I,{path:"/editor/:blog_id",element:e.jsx(ge,{})}),e.jsxs(I,{path:"/",element:e.jsx(Ge,{}),children:[e.jsx(I,{index:!0,element:e.jsx(pt,{})}),e.jsxs(I,{path:"dashboard",element:e.jsx(be,{}),children:[e.jsx(I,{path:"notifications",element:e.jsx(It,{})}),e.jsx(I,{path:"blogs",element:e.jsx(_t,{})})]}),e.jsxs(I,{path:"settings",element:e.jsx(be,{}),children:[e.jsx(I,{path:"edit-profile",element:e.jsx(Ft,{})}),e.jsx(I,{path:"change-password",element:e.jsx(Dt,{})})]}),e.jsx(I,{path:"signin",element:e.jsx(ue,{type:"sign-in"})}),e.jsx(I,{path:"signup",element:e.jsx(ue,{type:"sign-up"})}),e.jsx(I,{path:"search/:query",element:e.jsx(bt,{})}),e.jsx(I,{path:"user/:id",element:e.jsx(wt,{})}),e.jsx(I,{path:"blog/:blog_id",element:e.jsx(Pt,{})}),e.jsx(I,{path:"*",element:e.jsx(we,{})})]})]})})})};Ye.createRoot(document.getElementById("root")).render(e.jsx(Xe,{children:e.jsx(zt,{})}));
